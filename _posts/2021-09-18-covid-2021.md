---
layout: post
title: Covid-19, đối ứng đơn hàng với tình hình phong toả.
subtitle: Từ gốc độ các nhân trong việc xử lý đơn hàng trong tình hình phong toả.
cover-img: https://images.unsplash.com/photo-1587815280777-90694ad8c4ac
thumbnail-img: /assets/img/2021-09-18/2021_09_18.jpg
tags: [covid-19, programing]
---

Covid-19 có sự ảnh hưởng lớn nhất tại Hồ Chí Minh, đồng thời cũng ảnh hưởng đến tình hình kinh doanh của các sàn thương mại điện tử, nhất là việc nhận hàng từ kho hàng, người bán và giao hàng cho khách hàng, trong bài viết là gốc độ các nhân trong việc xử lý đơn hàng trong tình hình phong toả.

### Ngữ cảnh

Từ tháng 06/2021, thành phố Hồ Chí Minh tiến hành phong toả và có những thay đổi liên quan đến khu vực phong toả từ đơn giản đến phức tạp, từ phạm vi nhỏ đến lớn tuỳ vào tình hình lây lang dịch bệnh, thành phố lấy sức khoẻ của công dân là lưu tiên hàng đầu.

Một trong những chuỗi ảnh hưởng, đó là đơn vị vận chuyển như: GHN Express, GHTK, Ninja Vận, J&T, LEX (đối tác Lazada), ... không thể lấy hàng cũng như giao hàng cho khác hàng, cũng ảnh hưởng lớn tình hình vận hành và lưu thông hàng hoá của các sàn TMĐT.

### GHN Express

GHN Express xác định khu vực phong tỏa theo quận/huyện và phường/xã.

Từ API GHN Express, [Lấy danh sách mã Quận-Huyện](https://api.ghn.vn/home/docs/detail?id=93) và [Lấy danh sách mã Phường-Xã](https://api.ghn.vn/home/docs/detail?id=92), có những giá trị cụ thể từ `JSON`:

a. `SupportType`, cho từng khu vực quận/huyện, phường/xã, ứng với:

- `0`: GHN Express không thể đến khu vực lấy hàng và giao hàng.
- `1`: GHN Express có thể đến khu vực đó lấy hàng.
- `2`: GHN Express có thể đến khu vực giao hàng.
- `3`: GHN Express có thể đến khu vực lấy hàng và giao hàng.

b. `IsEnable`, cho từng khu vực quận/huyện, phường/xã, ứng với:

- `0`: khu vực, GHN Express không còn hoạt động
- `1`: khu vực, GHN Express còn hoạt động

#### Đối ứng

Từ thông tin API GHN Express có những đối ứng sau:

- Cập nhật thông tin quận/huyện và phường/xã từ GHN Expresss API, mỗi ngày (theo những khung giờ cụ thể) để xác định khu vực này còn hoạt động, hổ trợ giao hàng/lấy hàng hay không?
- Với những đơn hàng mới, cần hiển thị thông tin địa chỉ của Khách Hàng có nằm trong khu vực phong toả hay không? Từ đó, để khách hàng hiểu nguyên nhân không đặt được hàng hoặc giao hàng trễ, cũng như chọn một đơn vị vận chuyển phù hợp hơn.
- Với những đơn hàng cũ, bị ảnh hưởng không thể giao được, hệ thống tự động gửi email đến các bộ phận liên quan để nắm thông tin, từ đó có phương án phù hợp cho những đơn hàng này.

### Lazada

Cũng như các sàn TMĐT khác, Lazada họp tác với nhiều đơn vị vận chuyển, bản thân Lazada có LEX (đối tác Lazada) là đơn vị vận chuyển chính.

![Lazada](/assets/img/2021-09-18/lazada.png)

Trong hình tình phong toả, nhiều đơn vị vận chuyển không thể lấy hàng/giao hàng. Lazada có những bước linh hoạt là thay đổi đối tác vận chuyển đơn hàng bằng cách `repack` đơn hàng(đóng gói lại đơn hàng).

Quy trình về mặt vận hành thực tế:

- Nhà bán tiến hành `repack` đơn hàng.
- Lazada sẻ chỉ định đơn vị vận chuyển mới, đơn hàng sẽ chuyển trạng thái `pack`.
- Nhà bán tiến hành: lấy mã vận đơn, vận đơn (mới nhất), theo đơn vị vận chuyển (mới nhất) từ Lazada thay cho vận đơn củ và dán vào kiện hàng.
- Đơn hàng sẽ tiếp tục chuyển sang trạng thái sẳn sàng bàn giao cho đơn vị vận chuyển.

Quy trình về mặt trạng thái đơn hàng:

<img width="500" alt="Screen Shot 2021-08-29 at 10 54 08" src="https://tida.alicdn.com/oss_1631158638375_null_uF1OCLDV.png">

Sẽ thế nào nếu phải đối ứng `k x 1000` đơn hàng ?

#### Đối ứng

Từ [API SetRepack](https://open.lazada.com/doc/api.htm?spm=a2o9m.11193487.0.0.3ac413feEdYCJM#/api?cid=8&path=/order/repack), tiến hành các đối ứng sau:

- Xác định đơn hàng cần `repack`.
- Tiến hành repack hàng hoạt đơn hàng.
- Hệ thống tự động lấy lại vận đơn mới nhất từ Lazada,
  từ đây thấy là Ladaza thay đối tác `X` sang `LEX`.
- Hệ thống tự động cập nhật vận đơn mới cho các đối tác khác.
- Hệ thống tự động chuyển trạng thái sẳn sàng bàn giao cho đơn vị vận chuyển.

Hiện tại so với Tiki, Shoppe, Sendo thì chỉ có Lazada là hỗ trợ API như thế.

### Khác

Còn những đối ứng khác...

{: .box-warning}
**Warning:** bài viết thể hiện quan điểm cá nhân tác giả.

### Note

Ảnh `Thumbnail` là kết quả tự xét nghiệm Covid của mình, khi khu vực mình sống có F0.

[Cover Photo](https://unsplash.com/photos/GhtVhowMQvo)

[Thumbnail Photo](/assets/img/2021-09-18/2021_09_18.jpg)
